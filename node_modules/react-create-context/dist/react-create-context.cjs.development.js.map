{"version":3,"file":"react-create-context.cjs.development.js","sources":["../src/constants/isServer.ts","../src/hooks/useLocalStorageSync.ts","../src/utils/getFromLocalStorage.ts","../src/createContextStore.tsx","../src/createContextState.tsx"],"sourcesContent":["export const isServer = typeof window === 'undefined';\n","import { useEffect } from 'react';\nimport { isServer } from '../constants/isServer';\n\nexport const useLocalStorageSync = <State>(state: State, key?: string) => {\n  useEffect(() => {\n    if (key && !isServer) {\n      window.localStorage.setItem(key, JSON.stringify(state));\n    }\n  }, [state, key]);\n};\n","import { isServer } from '../constants/isServer';\n\nexport const getFromLocalStorage = <State>(key?: string): State | null => {\n  if (!key || isServer) return null;\n\n  const value = window.localStorage.getItem(key);\n\n  if (value) return JSON.parse(value);\n\n  return null;\n};\n","import React, {\n  createContext as reactCreateContext,\n  Dispatch,\n  FC,\n  Reducer,\n  useContext,\n  useReducer,\n} from 'react';\nimport { useLocalStorageSync } from './hooks/useLocalStorageSync';\nimport { getFromLocalStorage } from './utils/getFromLocalStorage';\n\nexport const createContextStore = <State, Actions>(\n  storeReducer: Reducer<State, Actions>,\n  initialState: State,\n  key?: string\n): [FC, () => State, () => Dispatch<Actions>] => {\n  const localStorageState = getFromLocalStorage<State>(key);\n  const initialOrSavedState = localStorageState ?? initialState;\n\n  const DispatchContext = reactCreateContext({});\n  const StoreContext = reactCreateContext(initialOrSavedState);\n\n  const StoreProvider: FC = ({ children }) => {\n    const [store, dispatch] = useReducer(storeReducer, initialOrSavedState);\n\n    useLocalStorageSync(store, key);\n\n    return (\n      <DispatchContext.Provider value={dispatch}>\n        <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n      </DispatchContext.Provider>\n    );\n  };\n\n  const useDispatch = () => useContext(DispatchContext) as Dispatch<Actions>;\n\n  const useStore = () => useContext(StoreContext);\n\n  return [StoreProvider, useStore, useDispatch];\n};\n","import React, {\n  createContext as reactCreateContext,\n  SetStateAction,\n  Dispatch,\n  FC,\n  useContext,\n  useState,\n} from 'react';\nimport { useLocalStorageSync } from './hooks/useLocalStorageSync';\nimport { getFromLocalStorage } from './utils/getFromLocalStorage';\n\nexport const createContextState = <State,>(\n  initialState: State,\n  key?: string\n): [FC, () => State, () => Dispatch<SetStateAction<State>>] => {\n  const localStorageState = getFromLocalStorage<State>(key);\n  const initialOrSavedState = localStorageState ?? initialState;\n\n  const SetStateContext = reactCreateContext({});\n  const StateContext = reactCreateContext(initialOrSavedState);\n\n  const StateProvider: FC = ({ children }) => {\n    const [state, setState] = useState(initialOrSavedState);\n\n    useLocalStorageSync(state, key);\n\n    return (\n      <SetStateContext.Provider value={setState}>\n        <StateContext.Provider value={state}>{children}</StateContext.Provider>\n      </SetStateContext.Provider>\n    );\n  };\n\n  const useContextSetState = () =>\n    useContext(SetStateContext) as Dispatch<SetStateAction<State>>;\n\n  const useContextState = () => useContext<State>(StateContext);\n\n  return [StateProvider, useContextState, useContextSetState];\n};\n"],"names":["isServer","window","useLocalStorageSync","state","key","useEffect","localStorage","setItem","JSON","stringify","getFromLocalStorage","value","getItem","parse","createContextStore","storeReducer","initialState","localStorageState","initialOrSavedState","DispatchContext","reactCreateContext","StoreContext","StoreProvider","children","useReducer","store","dispatch","React","Provider","useDispatch","useContext","useStore","createContextState","SetStateContext","StateContext","StateProvider","useState","setState","useContextSetState","useContextState"],"mappings":";;;;;;;;;AAAO,IAAMA,QAAQ,GAAG,OAAOC,MAAP,KAAkB,WAAnC;;ACGA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAQC,KAAR,EAAsBC,GAAtB;AACjCC,EAAAA,eAAS,CAAC;AACR,QAAID,GAAG,IAAI,CAACJ,QAAZ,EAAsB;AACpBC,MAAAA,MAAM,CAACK,YAAP,CAAoBC,OAApB,CAA4BH,GAA5B,EAAiCI,IAAI,CAACC,SAAL,CAAeN,KAAf,CAAjC;AACD;AACF,GAJQ,EAIN,CAACA,KAAD,EAAQC,GAAR,CAJM,CAAT;AAKD,CANM;;ACDA,IAAMM,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAQN,GAAR;AACjC,MAAI,CAACA,GAAD,IAAQJ,QAAZ,EAAsB,OAAO,IAAP;AAEtB,MAAMW,KAAK,GAAGV,MAAM,CAACK,YAAP,CAAoBM,OAApB,CAA4BR,GAA5B,CAAd;AAEA,MAAIO,KAAJ,EAAW,OAAOH,IAAI,CAACK,KAAL,CAAWF,KAAX,CAAP;AAEX,SAAO,IAAP;AACD,CARM;;ICSMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAChCC,YADgC,EAEhCC,YAFgC,EAGhCZ,GAHgC;AAKhC,MAAMa,iBAAiB,GAAGP,mBAAmB,CAAQN,GAAR,CAA7C;AACA,MAAMc,mBAAmB,GAAGD,iBAAH,WAAGA,iBAAH,GAAwBD,YAAjD;AAEA,MAAMG,eAAe,GAAGC,mBAAkB,CAAC,EAAD,CAA1C;AACA,MAAMC,YAAY,GAAGD,mBAAkB,CAACF,mBAAD,CAAvC;;AAEA,MAAMI,aAAa,GAAO,SAApBA,aAAoB;QAAGC,gBAAAA;;AAC3B,sBAA0BC,gBAAU,CAACT,YAAD,EAAeG,mBAAf,CAApC;AAAA,QAAOO,KAAP;AAAA,QAAcC,QAAd;;AAEAxB,IAAAA,mBAAmB,CAACuB,KAAD,EAAQrB,GAAR,CAAnB;AAEA,WACEuB,4BAAA,CAACR,eAAe,CAACS,QAAjB;AAA0BjB,MAAAA,KAAK,EAAEe;KAAjC,EACEC,4BAAA,CAACN,YAAY,CAACO,QAAd;AAAuBjB,MAAAA,KAAK,EAAEc;KAA9B,EAAsCF,QAAtC,CADF,CADF;AAKD,GAVD;;AAYA,MAAMM,WAAW,GAAG,SAAdA,WAAc;AAAA,WAAMC,gBAAU,CAACX,eAAD,CAAhB;AAAA,GAApB;;AAEA,MAAMY,QAAQ,GAAG,SAAXA,QAAW;AAAA,WAAMD,gBAAU,CAACT,YAAD,CAAhB;AAAA,GAAjB;;AAEA,SAAO,CAACC,aAAD,EAAgBS,QAAhB,EAA0BF,WAA1B,CAAP;AACD,CA5BM;;ICAMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAChChB,YADgC,EAEhCZ,GAFgC;AAIhC,MAAMa,iBAAiB,GAAGP,mBAAmB,CAAQN,GAAR,CAA7C;AACA,MAAMc,mBAAmB,GAAGD,iBAAH,WAAGA,iBAAH,GAAwBD,YAAjD;AAEA,MAAMiB,eAAe,GAAGb,mBAAkB,CAAC,EAAD,CAA1C;AACA,MAAMc,YAAY,GAAGd,mBAAkB,CAACF,mBAAD,CAAvC;;AAEA,MAAMiB,aAAa,GAAO,SAApBA,aAAoB;QAAGZ,gBAAAA;;AAC3B,oBAA0Ba,cAAQ,CAAClB,mBAAD,CAAlC;AAAA,QAAOf,KAAP;AAAA,QAAckC,QAAd;;AAEAnC,IAAAA,mBAAmB,CAACC,KAAD,EAAQC,GAAR,CAAnB;AAEA,WACEuB,4BAAA,CAACM,eAAe,CAACL,QAAjB;AAA0BjB,MAAAA,KAAK,EAAE0B;KAAjC,EACEV,4BAAA,CAACO,YAAY,CAACN,QAAd;AAAuBjB,MAAAA,KAAK,EAAER;KAA9B,EAAsCoB,QAAtC,CADF,CADF;AAKD,GAVD;;AAYA,MAAMe,kBAAkB,GAAG,SAArBA,kBAAqB;AAAA,WACzBR,gBAAU,CAACG,eAAD,CADe;AAAA,GAA3B;;AAGA,MAAMM,eAAe,GAAG,SAAlBA,eAAkB;AAAA,WAAMT,gBAAU,CAAQI,YAAR,CAAhB;AAAA,GAAxB;;AAEA,SAAO,CAACC,aAAD,EAAgBI,eAAhB,EAAiCD,kBAAjC,CAAP;AACD,CA5BM;;;;;"}