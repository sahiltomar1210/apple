{"version":3,"file":"react-create-context.cjs.production.min.js","sources":["../src/constants/isServer.ts","../src/hooks/useLocalStorageSync.ts","../src/utils/getFromLocalStorage.ts","../src/createContextState.tsx","../src/createContextStore.tsx"],"sourcesContent":["export const isServer = typeof window === 'undefined';\n","import { useEffect } from 'react';\nimport { isServer } from '../constants/isServer';\n\nexport const useLocalStorageSync = <State>(state: State, key?: string) => {\n  useEffect(() => {\n    if (key && !isServer) {\n      window.localStorage.setItem(key, JSON.stringify(state));\n    }\n  }, [state, key]);\n};\n","import { isServer } from '../constants/isServer';\n\nexport const getFromLocalStorage = <State>(key?: string): State | null => {\n  if (!key || isServer) return null;\n\n  const value = window.localStorage.getItem(key);\n\n  if (value) return JSON.parse(value);\n\n  return null;\n};\n","import React, {\n  createContext as reactCreateContext,\n  SetStateAction,\n  Dispatch,\n  FC,\n  useContext,\n  useState,\n} from 'react';\nimport { useLocalStorageSync } from './hooks/useLocalStorageSync';\nimport { getFromLocalStorage } from './utils/getFromLocalStorage';\n\nexport const createContextState = <State,>(\n  initialState: State,\n  key?: string\n): [FC, () => State, () => Dispatch<SetStateAction<State>>] => {\n  const localStorageState = getFromLocalStorage<State>(key);\n  const initialOrSavedState = localStorageState ?? initialState;\n\n  const SetStateContext = reactCreateContext({});\n  const StateContext = reactCreateContext(initialOrSavedState);\n\n  const StateProvider: FC = ({ children }) => {\n    const [state, setState] = useState(initialOrSavedState);\n\n    useLocalStorageSync(state, key);\n\n    return (\n      <SetStateContext.Provider value={setState}>\n        <StateContext.Provider value={state}>{children}</StateContext.Provider>\n      </SetStateContext.Provider>\n    );\n  };\n\n  const useContextSetState = () =>\n    useContext(SetStateContext) as Dispatch<SetStateAction<State>>;\n\n  const useContextState = () => useContext<State>(StateContext);\n\n  return [StateProvider, useContextState, useContextSetState];\n};\n","import React, {\n  createContext as reactCreateContext,\n  Dispatch,\n  FC,\n  Reducer,\n  useContext,\n  useReducer,\n} from 'react';\nimport { useLocalStorageSync } from './hooks/useLocalStorageSync';\nimport { getFromLocalStorage } from './utils/getFromLocalStorage';\n\nexport const createContextStore = <State, Actions>(\n  storeReducer: Reducer<State, Actions>,\n  initialState: State,\n  key?: string\n): [FC, () => State, () => Dispatch<Actions>] => {\n  const localStorageState = getFromLocalStorage<State>(key);\n  const initialOrSavedState = localStorageState ?? initialState;\n\n  const DispatchContext = reactCreateContext({});\n  const StoreContext = reactCreateContext(initialOrSavedState);\n\n  const StoreProvider: FC = ({ children }) => {\n    const [store, dispatch] = useReducer(storeReducer, initialOrSavedState);\n\n    useLocalStorageSync(store, key);\n\n    return (\n      <DispatchContext.Provider value={dispatch}>\n        <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n      </DispatchContext.Provider>\n    );\n  };\n\n  const useDispatch = () => useContext(DispatchContext) as Dispatch<Actions>;\n\n  const useStore = () => useContext(StoreContext);\n\n  return [StoreProvider, useStore, useDispatch];\n};\n"],"names":["isServer","window","useLocalStorageSync","state","key","useEffect","localStorage","setItem","JSON","stringify","getFromLocalStorage","value","getItem","parse","initialState","localStorageState","initialOrSavedState","SetStateContext","reactCreateContext","StateContext","children","useState","setState","React","Provider","useContext","storeReducer","DispatchContext","StoreContext","useReducer","store","dispatch"],"mappings":"oJAAaA,EAA6B,oBAAXC,OCGlBC,EAAsB,SAAQC,EAAcC,GACvDC,aAAU,WACJD,IAAQJ,GACVC,OAAOK,aAAaC,QAAQH,EAAKI,KAAKC,UAAUN,MAEjD,CAACA,EAAOC,KCNAM,EAAsB,SAAQN,OACpCA,GAAOJ,EAAU,OAAO,SAEvBW,EAAQV,OAAOK,aAAaM,QAAQR,UAEtCO,EAAcH,KAAKK,MAAMF,GAEtB,iCCEyB,SAChCG,EACAV,OAEMW,EAAoBL,EAA2BN,GAC/CY,QAAsBD,EAAAA,EAAqBD,EAE3CG,EAAkBC,gBAAmB,IACrCC,EAAeD,gBAAmBF,SAmBjC,CAjBmB,gBAAGI,IAAAA,WACDC,WAASL,GAA5Bb,OAAOmB,cAEdpB,EAAoBC,EAAOC,GAGzBmB,gBAACN,EAAgBO,UAASb,MAAOW,GAC/BC,gBAACJ,EAAaK,UAASb,MAAOR,GAAQiB,KAQpB,kBAAMK,aAAkBN,IAHrB,kBACzBM,aAAWR,iCCvBmB,SAChCS,EACAZ,EACAV,OAEMW,EAAoBL,EAA2BN,GAC/CY,QAAsBD,EAAAA,EAAqBD,EAE3Ca,EAAkBT,gBAAmB,IACrCU,EAAeV,gBAAmBF,SAkBjC,CAhBmB,gBAAGI,IAAAA,WACDS,aAAWH,EAAcV,GAA5Cc,OAAOC,cAEd7B,EAAoB4B,EAAO1B,GAGzBmB,gBAACI,EAAgBH,UAASb,MAAOoB,GAC/BR,gBAACK,EAAaJ,UAASb,MAAOmB,GAAQV,KAO3B,kBAAMK,aAAWG,IAFd,kBAAMH,aAAWE"}